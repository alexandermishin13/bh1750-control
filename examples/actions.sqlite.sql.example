BEGIN TRANSACTION;
CREATE TABLE scopes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    scope TEXT NOT NULL UNIQUE
);
INSERT INTO scopes VALUES(0,'Default');
INSERT INTO scopes VALUES(1,'clock-switch');
INSERT INTO scopes VALUES(2,'clock-brightness');
CREATE TABLE illuminance (
    level INT NOT NULL,
    scopeid INT NOT NULL,
    delay INT NOT NULL DEFAULT 0,
    action TEXT NOT NULL,
    PRIMARY KEY (level, scopeid),
    CONSTRAINT fk_scopes
        FOREIGN KEY (scopeid)
        REFERENCES scopes(id)
        ON UPDATE CASCADE
        ON DELETE CASCADE
) WITHOUT ROWID;
INSERT INTO illuminance VALUES(0,1,60,'/sbin/sysctl dev.tm1637.0.on=0');
INSERT INTO illuminance VALUES(0,2,0,'/sbin/sysctl dev.tm1637.0.brightness=0');
INSERT INTO illuminance VALUES(1,1,0,'/sbin/sysctl dev.tm1637.0.on=1');
INSERT INTO illuminance VALUES(30000,2,0,'/sbin/sysctl dev.tm1637.0.brightness=1');
INSERT INTO illuminance VALUES(40000,2,0,'/sbin/sysctl dev.tm1637.0.brightness=2');
INSERT INTO illuminance VALUES(50000,2,0,'/sbin/sysctl dev.tm1637.0.brightness=3');
INSERT INTO illuminance VALUES(60000,2,0,'/sbin/sysctl dev.tm1637.0.brightness=4');
DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('scopes',2);
CREATE INDEX index_scope_level ON illuminance(scopeid, level);
COMMIT;
